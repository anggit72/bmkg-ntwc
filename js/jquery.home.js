if($.ajax({url:"sidebar_left.html",success:function(e){$("#sidebar_left").html(e)}}),$.cookie("test-data"))getGempa_awal();else{var ex1={attr1:"test",attr2:"test"};$.cookie("test-data",JSON.stringify(ex1))}var timer,ex2={attr3:"test",attr4:"test",fase1:"test",fase2:"test"};$.cookie("test-data2",JSON.stringify(ex2));const map2=L.map("mapshake",{zoomControl:!1,attributionControl:!1}).setView([-8.39,117.46],9);var street=L.esri.basemapLayer("Streets").addTo(map2),green1=L.icon({iconUrl:"epic2.png",iconSize:[25,25]}),pulsingIcon=L.icon.pulse({iconSize:[30,30],color:"red",animate:!0,heartbeat:2}),pulsingIcon2=L.icon.pulse({iconSize:[10,10],color:"red",animate:!0,heartbeat:3});let marker=L.marker([0,0],{icon:pulsingIcon}).addTo(map),marker3=L.marker([0,0],{icon:pulsingIcon2}).addTo(map2),markershake=L.marker([-8.39,117.46],{icon:green1}).addTo(map2);var myStyle={color:"red",weight:1,opacity:1},localfault=new L.LayerGroup;d3.json("https://bmkg-content-inatews.storage.googleapis.com/indo_faults_lines.geojson",function(e){L.geoJSON(e,{color:"orange",weight:1}).addTo(map)});let firstTime=!0;var time;async function getGempa(){var e=+new Date;api_url="https://bmkg-content-inatews.storage.googleapis.com/datagempa.json?t="+e;const t=await fetch(api_url),a=await t.json(),{latitude:n,longitude:o,info:i,OT:d,depth:s,ket:l,identifier:r,sent:m,area:c}=a;var u=r,p=$.cookie("test-data");if(obj=JSON.parse(p,(e,t)=>("attr2"==e&&(t=u),t)),obj.attr1!=obj.attr2){i.area.split("-")[0].split("di");var g=i.magnitude.split("."),f=g[0]+","+g[1];i.potential,i.instruction;new Audio("sound/tingtong.mp3").play();new Audio("sound/eq2.mp3");var y=new Audio("sound/g5.mp3"),h=new Audio("sound/gd.mp3"),T=new Audio("sound/pd1.mp3"),_=new Audio("sound/pd2.mp3"),w=new Audio("sound/pd3.mp3"),k=new Audio("sound/pd4.mp3"),b=i.subject.split(".")[0];if("Warning Tsunami PD-1"==b)(L=$("#myModal")).modal("show"),timer=setTimeout(function(){L.modal("hide")},6e5),T.play();else if("Warning Tsunami PD-2"==b){clearTimeout(timer),(L=$("#myModal")).modal("show"),timer=setTimeout(function(){L.modal("hide")},6e5),_.play()}else if("Warning Tsunami PD-3"==b){clearTimeout(timer),(L=$("#myModal")).modal("show"),timer=setTimeout(function(){L.modal("hide")},6e5),w.play()}else if("Warning Tsunami PD-4"==b){clearTimeout(timer),(L=$("#myModal")).modal("show"),timer=setTimeout(function(){L.modal("hide")},6e5),k.play()}else if("Warning Gempa dirasakan"==b){clearTimeout(timer),(L=$("#myModal")).modal("hide"),h.play()}else if("Gempa M>5"==b){var L;clearTimeout(timer),(L=$("#myModal")).modal("hide"),y.play()}var j=i.point.coordinates.split(",");markershake.setLatLng([j[1],j[0]]).bindPopup(i.headline),marker3.setLatLng([j[1],j[0]]).bindPopup(i.headline);j[1],j[0];if(firstTime&&(map2.setView([j[1],j[0]],5),firstTime=!0),"Warning Gempa dirasakan"==i.subject)var I=i.subject.split(" "),v="Info "+I[1]+" "+I[2];else v=i.subject;document.getElementById("potential").innerText=i.potential,document.getElementById("instruction").innerHTML="<i>Arahan BMKG</i> </br>"+i.instruction,document.getElementById("judul").innerText=v,document.getElementById("mag").innerHTML=f,document.getElementById("deskripsi").innerText=i.headline,document.getElementById("timelapse").innerHTML="waktu kirim: "+i.timesent,document.getElementById("tanggal").innerHTML="<span style='color: red;'><i class='fas fa-clock'></i></span>"+i.date+" "+i.time,document.getElementById("point").innerHTML="<span style='color: orange;'><i class='fas fa-bullseye'></i></span>"+i.latitude+", "+i.longitude,document.getElementById("depth").innerHTML="<span style='color: green;'><i class='fas fa-podcast '></i></span> "+i.depth,$.ajax({type:"GET",cache:!1,url:"https://bmkg-content-inatews.storage.googleapis.com/datagempa.json",dataType:"json",success:function(e){console.log(e);const t=e,{latitude:a,longitude:n,info:o,OT:i,depth:d,ket:s,identifier:l,sent:r,magnitude:m,subject:c}=t;var u=o.subject.split(".")[0];"Warning Tsunami PD-1"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd1.html")}):"Warning Tsunami PD-2"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd2.html")}):"Warning Tsunami PD-3"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd3.html")}):"Warning Tsunami PD-4"==u&&$(document).ready(function(){$("#pd1").load("file_modal/modal_pd4.html")})}})}p={attr1:u,attr2:u};$.cookie("test-data",JSON.stringify(p),{expires:1e3})}getGempa(),setInterval(getGempa,5e3),$("#myModal").on("show.bs.modal",function(e){$.ajax({type:"GET",cache:!1,url:"https://bmkg-content-inatews.storage.googleapis.com/datagempa.json",dataType:"json",success:function(e){const t=e,{latitude:a,longitude:n,info:o,OT:i,depth:d,ket:s,identifier:l,sent:r,magnitude:m,subject:c}=t;var u=o.subject.split(".")[0];"Warning Tsunami PD-1"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd1_manual.html")}):"Warning Tsunami PD-2"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd2_manual.html")}):"Warning Tsunami PD-3"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd3_manual.html")}):"Warning Tsunami PD-4"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_pd4_manual.html")}):"Warning Gempa dirasakan"==u?$(document).ready(function(){$("#pd1").load("file_modal/modal_dirasakan_manual.html")}):"Gempa M>5"==u&&$(document).ready(function(){$("#pd1").load("file_modal/modal_m5_manual.html")})}})}),$("#modal3").on("show.bs.modal",function(e){$.ajax({type:"GET",cache:!1,url:"https://bmkg-content-inatews.storage.googleapis.com/datagempa.json",dataType:"json",success:function(e){$(document).ready(function(){$("#isi3").load("file_modal/glosary.html")})}})}),$("#modal4").on("show.bs.modal",function(e){$.ajax({type:"GET",cache:!1,url:"https://bmkg-content-inatews.storage.googleapis.com/datagempa.json",dataType:"json",success:function(e){$(document).ready(function(){$("#isi4").load("file_modal/modal_menulink.html")})}})}),$("#modal5").on("show.bs.modal",function(e){$.ajax({type:"GET",cache:!1,url:"https://bmkg-content-inatews.storage.googleapis.com/datagempa.json",dataType:"json",success:function(e){$(document).ready(function(){$("#isi5").load("file_modal/modal_mmi.html")})}})});var lat_user,lon_user,data={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[85,15],[165,15],[165,-15],[85,-15],[85,15]]}}]};function styledPolyline(e,t,a){L.polyline(e,{color:"#333",weight:6,opacity:.9}).addTo(t),L.polyline(e,{color:"#fff",weight:4,opacity:1}).addTo(t),L.polyline(e,{color:a||"#2196f3",weight:2,opacity:.9}).addTo(t)}async function getGempa_awal(){var e=+new Date;api_url="https://bmkg-content-inatews.storage.googleapis.com/datagempa.json?t="+e;const t=await fetch(api_url),a=await t.json(),{latitude:n,longitude:o,info:i,OT:d,depth:s,ket:l,identifier:r,sent:m,area:c}=a;i.area.split("-")[0].split("di");var u=i.magnitude.split("."),p=u[0]+","+u[1],g=(i.potential,i.instruction,i.point.coordinates.split(","));if(markershake.setLatLng([g[1],g[0]]).bindPopup(i.headline),marker3.setLatLng([g[1],g[0]]).bindPopup(i.headline),map2.setView([g[1],g[0]],6),"Warning Gempa dirasakan"==i.subject)var f=i.subject.split(" "),y="Info "+f[1]+" "+f[2];else y=i.subject;document.getElementById("potential").innerText=i.potential,document.getElementById("instruction").innerHTML="<i>Arahan BMKG</i> </br>"+i.instruction,document.getElementById("judul").innerText=y,document.getElementById("mag").innerHTML=p,document.getElementById("deskripsi").innerText=i.headline,document.getElementById("timelapse").innerHTML="waktu kirim: "+i.timesent,document.getElementById("tanggal").innerHTML="<span style='color: red;'><i class='fas fa-clock'></i></span>"+i.date+" "+i.time,document.getElementById("point").innerHTML="<span style='color: orange;'><i class='fas fa-bullseye'></i></span>"+i.latitude+", "+i.longitude,document.getElementById("depth").innerHTML="<span style='color: green;'><i class='fas fa-podcast '></i></span> "+i.depth}function getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition)}function showPosition(e){lat_user=e.coords.latitude,lon_user=e.coords.longitude,$.post("https://pgt.bmkg.go.id/ntwc_cloud/active_users.php",{data:lat_user+"_"+lon_user})}L.geoJSON(data,{style:function(e){return{color:e.properties.color||"red",dashArray:"8 6",weight:1}}}).bindPopup(function(e){return e.feature.properties.description||"tere"}).addTo(map),getLocation(),setInterval(getLocation,18e5);